#!/bin/bash 
name=$(date | md5sum | awk '{print "php56-cli-"$1}')

HOST=$(hostname -I | awk '{print $1}')
CMD_HOST=""
if [[ $HOST ]]; then
    CMD_HOST="--add-host=host.docker.internal:$HOST"
fi

COMMAND="php $@"
USE_TTY=""
if [[ "$1" == "bash" ]]; then
    COMMAND="bash"
    USE_TTY="t"
fi

docker run -i --rm --name $name \
  -v "$PWD":"$PWD" \
  -w $PWD \
  -e XDEBUG_CONFIG="${XDEBUG_CONFIG}" \
  -e XDEBUG_SESSION_START="${XDEBUG_SESSION_START}" \
  --network "host" \
  $CMD_HOST \
  silmaralberti/php:5.6-apache-dev $COMMAND